//= require jQuery/gmap3

var molydeux = (function(md, $) {
  
  function Location () {
    
    this.init = function() {
      
      $('.map').gmap3({
        map: {
          options: {
                maxZoom: 14
            }
        },
        marker: {
            address: this.address,
            options: {
                icon: this.icon
            }
        }
      }, "autofit");

      
    };
    
    this.getAddress = function() {
      
      var address = "";
      
      address = $('#address').text();
      
      if(address.trim() === ""){
        address = "Atlantic Ocean";
      }
      
      return address;
      
    };
    
    this.makeIcon = function(imagePath, width, height) {
      var myIcon = null;
      
      myIcon = new google.maps.MarkerImage(imagePath, 
        new google.maps.Size(width, height, "px", "px")
      );
      
      return myIcon;
      
    };
    
    this.icon = this.makeIcon("<%= asset_path('venues/pixel-marker.png') %>", 40, 50);
    this.address = this.getAddress();
  
  };
  
  md.location = new Location();
  
  $(document).ready(function() {
    md.location.init();
  });
  
  return md;
  
}(molydeux || {}, jQuery));